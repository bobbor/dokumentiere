<!DOCTYPE html><html><head><meta charset="utf-8"><title>src\foldercopy.js Dokumentation (Source)</title><link rel="stylesheet" href="css/style.css" media="all"><link rel="stylesheet" href="css/font-awesome.css" media="all"><link rel="stylesheet" href="css/sh.min.css" media="all"><script src="js/sh_main.min.js"></script><script src="js/sh_javascript.min.js"></script><script data-main="js/main.js" src="js/libs/require-jquery.js"></script></head><body id="source" onload="sh_highlightDocument();"><div id="wrapper"><div id="main"><aside class="items"><header><h1><a href="index.html"><em>Aperto</em><span><b>JS</b>Docs</span></a></h1></header><div id="filter"><form><div class="col col-3"><input type="search" placeholder="Suche" name="filter"><button><span>Los</span></button></div><div class="col col-9"><ul class="props"><li><input id="node-module" type="checkbox" name="node-module" checked><label for="node-module">node-module</label></li></ul></div></form></div><section data-type="node-module" data-name="doku" class="col col-3"><h1><a href="node.doku.html">doku</a></h1><h2>node-module (node)</h2><p>starts documentation on the files</p></section><section data-type="node-module" data-name="foldercopy" class="col col-3"><h1><a href="node.foldercopy.html">foldercopy</a></h1><h2>node-module (node)</h2><p>copies the specified folder</p></section><section data-type="node-module" data-name="tags" class="col col-3"><h1><a href="node.tags.html">tags</a></h1><h2>node-module (node)</h2><p>this parses the &quot;tags&quot;</p></section><section data-type="node-module" data-name="tmpl" class="col col-3"><h1><a href="node.tmpl.html">tmpl</a></h1><h2>node-module (node)</h2><p>gets the parsed comments and generates the html</p></section></aside><div id="content"><h1> <span>Source View</span>src\foldercopy.js</h1><pre class="sh_javascript">//
// /--------------------------------------------\
// |                                            |
// | foldercopy.js                              |
// | part of &quot;dokumentiere&quot;                     |
// | licensed under GPLv2                       |
// |                                            |
// \--------------------------------------------/

var fs = require( 'fs' );
var cwd = process.cwd();
var path = require( 'path' );
/*-
 * foldercopy
 [ node-module (node) ]
 * copies the specified folder
 * it does it recursively from the source-folder to destination-folder including all files
 &gt; Usage
 | var fc = require('foldercopy');
 -*/
var foldercopy = {
	/*-
	 * recursiveCopy(folders, p, dest)
	 [ function (public) ]
	 * copies the specified folders
	 * the function looks in the source folder for the dirs and copies them recursively to the destination
	 &gt; Parameter
	 - folders (array) an array of folder names
	 - p (array) an array of foldernames, that get concatinated using path.sep
	 - dest (string) the destination folder
	 -*/
	recursiveCopy: function( folders, p, dest ) {
		var that = this;
		var base = __dirname + path.sep + p.join( path.sep );
		dest = cwd + path.sep + dest;
		folders.forEach( function( elm, i, folders ) {
			that.copyFolder( base, elm, '', dest );
		} );
	},
	/*-
	 * copyFolder(base, folder, recurse, dest)
	 [ function (public) ]
	 * copies the specified folder
	 &gt; Parameter
	 - base (string) the base folder where to look
	 - folder (string) the name of the folder in &quot;base&quot; to copy
	 - recurse (string) how deep we have iterated (it gets appended to dest)
	 - dest (string) the destination folder
	 -*/
	copyFolder: function( base, folder, recurse, dest ) {
		var that = this;
		fs.mkdir( dest + path.sep + folder + path.sep + recurse, function() {
			fs.readdir( base + path.sep + folder + path.sep + recurse, function( err, files ) {
				iterator( files, function( item ) {
					fs.stat( base + path.sep + folder + path.sep + recurse + item, function( err, stat ) {
						if ( err ) {
							console.log( err );
							return;
						}
						if ( stat.isDirectory() ) {
							that.copyFolder( base, folder, recurse + item + path.sep, dest );
							return;
						}
						that.copyFile( base + path.sep + folder + path.sep + recurse, item, dest + path.sep + folder + path.sep + recurse );
					} );
				}, function() {} );
			} );
		} );
	},
	/*-
	 * copyFile(base, file, dest)
	 [ function (public) ]
	 * copies the specified file
	 &gt; Parameter
	 - base (array) the base folder where to look
	 - file (array) the name of the file in &quot;base&quot; to copy
	 - dest (string) the destination folder
	 -*/
	copyFile: function( base, file, dest ) {
		fs.readFile( base + file, function( err, data ) {
			if ( err ) {
				console.log( err );
				return;
			}
			fs.writeFile( dest + file, data, function( o_O ) {
				if ( o_O ) {
					console.log( o_O );
					return;
				}
				// console.log('copied '+file+' to '+dest);
			} );
		} );
	}
};

/*-
 * iterator(arr, fneach, fnend)
 [ function (private) ]
 * iterates over an array
 * during iteration it calls fneach for each element and fnend when iteration is done
 &gt; Parameter
 - arr (array) the array to iterate over
 - fneach (function) the function to call on each item
 - fnend (function) the function to call when iteration is done
 -*/
var iterator = function( arr, fneach, fnend ) {
	if ( !arr.length ) {
		fnend();
		return;
	}
	var item = arr.pop();
	fneach( item );
	iterator( arr, fneach, fnend );
};

module.exports = foldercopy;
</pre></div></div></div></body></html>